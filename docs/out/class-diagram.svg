<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="795px" preserveAspectRatio="none" style="width:856px;height:795px;background:#FFFFFF;" version="1.1" viewBox="0 0 856 795" width="856px" zoomAndPan="magnify"><defs><filter height="300%" id="f12b7wkof0s6r6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[8523c9eb2e1b5151dfc9c2a797373c5f]
class Scheduler--><rect codeLine="2" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="138.6855" id="Scheduler" style="stroke:#A80036;stroke-width:1.5;" width="166" x="7" y="283"/><ellipse cx="57.75" cy="299" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M60.2231,305.1431 Q59.6421,305.4419 59.0029,305.5913 Q58.3638,305.7407 57.6582,305.7407 Q55.1514,305.7407 53.8315,304.0889 Q52.5117,302.437 52.5117,299.3159 Q52.5117,296.1865 53.8315,294.5347 Q55.1514,292.8828 57.6582,292.8828 Q58.3638,292.8828 59.0112,293.0322 Q59.6587,293.1816 60.2231,293.4805 L60.2231,296.2031 Q59.5923,295.6221 58.9988,295.3523 Q58.4053,295.0825 57.7744,295.0825 Q56.4297,295.0825 55.7449,296.1492 Q55.0601,297.2158 55.0601,299.3159 Q55.0601,301.4077 55.7449,302.4744 Q56.4297,303.541 57.7744,303.541 Q58.4053,303.541 58.9988,303.2712 Q59.5923,303.0015 60.2231,302.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="56" x="78.25" y="303.5352">Scheduler</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="172" y1="315" y2="315"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="323"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="27" y="329.6348">basePeriod: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="335.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="27" y="342.5898">tasks: list&lt;Task*&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="348.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="72" x="27" y="355.5449">timer: Timer1</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="361.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="27" y="368.5">elapsedTime: int</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="172" y1="374.8203" y2="374.8203"/><ellipse cx="18" cy="385.8203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="140" x="27" y="389.4551">Scheduler(basePeriod: int)</text><ellipse cx="18" cy="398.7754" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="138" x="27" y="402.4102">addTask(task:Task*): bool</text><ellipse cx="18" cy="411.7305" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="27" y="415.3652">schedule()</text><!--MD5=[b34797a66dc35cbf1d65f7e3ca75530e]
class Task--><rect codeLine="12" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="112.7754" id="Task" style="stroke:#A80036;stroke-width:1.5;" width="261" x="208.5" y="296"/><ellipse cx="320.75" cy="312" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M317.1777,308.2651 L317.1777,306.1069 L324.5571,306.1069 L324.5571,308.2651 L322.0918,308.2651 L322.0918,316.3418 L324.5571,316.3418 L324.5571,318.5 L317.1777,318.5 L317.1777,316.3418 L319.6431,316.3418 L319.6431,308.2651 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="341.25" y="316.5352">Task</text><line style="stroke:#A80036;stroke-width:1.5;" x1="209.5" x2="468.5" y1="328" y2="328"/><line style="stroke:#A80036;stroke-width:1.5;" x1="209.5" x2="468.5" y1="336" y2="336"/><ellipse cx="219.5" cy="347" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="228.5" y="350.6348">init(state: State*)</text><ellipse cx="219.5" cy="359.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="176" x="228.5" y="363.5898">stateTransition(nextState: State*)</text><ellipse cx="219.5" cy="372.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="228.5" y="376.5449">execute()</text><ellipse cx="219.5" cy="385.8652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="235" x="228.5" y="389.5">updateAndCheckTime(basePeriod: int): bool</text><ellipse cx="219.5" cy="398.8203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="124" x="228.5" y="402.4551">getMachine(): Machine*</text><!--MD5=[39bd0ac90f9970b9ca5c1ec8f6997e50]
class BaseTask--><rect codeLine="22" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="190.5059" id="BaseTask" style="stroke:#A80036;stroke-width:1.5;" width="261" x="208.5" y="482"/><ellipse cx="307.25" cy="498" fill="#A9DCDF" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M307.1133,493.3481 L305.9595,498.4199 L308.2754,498.4199 Z M305.6191,491.1069 L308.6157,491.1069 L311.9609,503.5 L309.5122,503.5 L308.7485,500.437 L305.4697,500.437 L304.7227,503.5 L302.2739,503.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="327.75" y="502.5352">BaseTask</text><line style="stroke:#A80036;stroke-width:1.5;" x1="209.5" x2="468.5" y1="514" y2="514"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="522"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="70" x="228.5" y="528.6348">myPeriod: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="534.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="228.5" y="541.5898">elapsedTime: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="547.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="103" x="228.5" y="554.5449">currentState: State*</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="560.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="228.5" y="567.5">machine: Machine*</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="573.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="228.5" y="580.4551">actualState: State*</text><line style="stroke:#A80036;stroke-width:1.5;" x1="209.5" x2="468.5" y1="586.7754" y2="586.7754"/><ellipse cx="219.5" cy="597.7754" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="228.5" y="601.4102">Task(period: int)</text><ellipse cx="219.5" cy="610.7305" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="88" x="228.5" y="614.3652">init(state: State*)</text><ellipse cx="219.5" cy="623.6855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="176" x="228.5" y="627.3203">stateTransition(nextState: State*)</text><ellipse cx="219.5" cy="636.6406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="228.5" y="640.2754">execute()</text><ellipse cx="219.5" cy="649.5957" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="235" x="228.5" y="653.2305">updateAndCheckTime(basePeriod: int): bool</text><ellipse cx="219.5" cy="662.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="124" x="228.5" y="666.1855">getMachine(): Machine*</text><!--MD5=[bd26e0f15110d33a434615c35349b6ef]
class MainTask--><rect codeLine="36" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="48" id="MainTask" style="stroke:#A80036;stroke-width:1.5;" width="87" x="76.5" y="733"/><ellipse cx="91.5" cy="749" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M93.9731,755.1431 Q93.3921,755.4419 92.7529,755.5913 Q92.1138,755.7407 91.4082,755.7407 Q88.9014,755.7407 87.5815,754.0889 Q86.2617,752.437 86.2617,749.3159 Q86.2617,746.1865 87.5815,744.5347 Q88.9014,742.8828 91.4082,742.8828 Q92.1138,742.8828 92.7612,743.0322 Q93.4087,743.1816 93.9731,743.4805 L93.9731,746.2031 Q93.3423,745.6221 92.7488,745.3523 Q92.1553,745.0825 91.5244,745.0825 Q90.1797,745.0825 89.4949,746.1492 Q88.8101,747.2158 88.8101,749.3159 Q88.8101,751.4077 89.4949,752.4744 Q90.1797,753.541 91.5244,753.541 Q92.1553,753.541 92.7488,753.2712 Q93.3423,753.0015 93.9731,752.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="55" x="105.5" y="753.5352">MainTask</text><line style="stroke:#A80036;stroke-width:1.5;" x1="77.5" x2="162.5" y1="765" y2="765"/><line style="stroke:#A80036;stroke-width:1.5;" x1="77.5" x2="162.5" y1="773" y2="773"/><!--MD5=[4a587509b3bde4518f7f65a764120a5f]
class DispensingTask--><rect codeLine="37" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="48" id="DispensingTask" style="stroke:#A80036;stroke-width:1.5;" width="123" x="198.5" y="733"/><ellipse cx="213.5" cy="749" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M215.9731,755.1431 Q215.3921,755.4419 214.7529,755.5913 Q214.1138,755.7407 213.4082,755.7407 Q210.9014,755.7407 209.5815,754.0889 Q208.2617,752.437 208.2617,749.3159 Q208.2617,746.1865 209.5815,744.5347 Q210.9014,742.8828 213.4082,742.8828 Q214.1138,742.8828 214.7612,743.0322 Q215.4087,743.1816 215.9731,743.4805 L215.9731,746.2031 Q215.3423,745.6221 214.7488,745.3523 Q214.1553,745.0825 213.5244,745.0825 Q212.1797,745.0825 211.4949,746.1492 Q210.8101,747.2158 210.8101,749.3159 Q210.8101,751.4077 211.4949,752.4744 Q212.1797,753.541 213.5244,753.541 Q214.1553,753.541 214.7488,753.2712 Q215.3423,753.0015 215.9731,752.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="227.5" y="753.5352">DispensingTask</text><line style="stroke:#A80036;stroke-width:1.5;" x1="199.5" x2="320.5" y1="765" y2="765"/><line style="stroke:#A80036;stroke-width:1.5;" x1="199.5" x2="320.5" y1="773" y2="773"/><!--MD5=[b8052483777247ddb47d43c6a0e44141]
class SelfTestingTask--><rect codeLine="38" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="48" id="SelfTestingTask" style="stroke:#A80036;stroke-width:1.5;" width="122" x="357" y="733"/><ellipse cx="372" cy="749" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M374.4731,755.1431 Q373.8921,755.4419 373.2529,755.5913 Q372.6138,755.7407 371.9082,755.7407 Q369.4014,755.7407 368.0815,754.0889 Q366.7617,752.437 366.7617,749.3159 Q366.7617,746.1865 368.0815,744.5347 Q369.4014,742.8828 371.9082,742.8828 Q372.6138,742.8828 373.2612,743.0322 Q373.9087,743.1816 374.4731,743.4805 L374.4731,746.2031 Q373.8423,745.6221 373.2488,745.3523 Q372.6553,745.0825 372.0244,745.0825 Q370.6797,745.0825 369.9949,746.1492 Q369.3101,747.2158 369.3101,749.3159 Q369.3101,751.4077 369.9949,752.4744 Q370.6797,753.541 372.0244,753.541 Q372.6553,753.541 373.2488,753.2712 Q373.8423,753.0015 374.4731,752.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="386" y="753.5352">SelfTestingTask</text><line style="stroke:#A80036;stroke-width:1.5;" x1="358" x2="478" y1="765" y2="765"/><line style="stroke:#A80036;stroke-width:1.5;" x1="358" x2="478" y1="773" y2="773"/><!--MD5=[514c6b350592fd19bedc81e7ac20daaf]
class CommunicationTask--><rect codeLine="39" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="48" id="CommunicationTask" style="stroke:#A80036;stroke-width:1.5;" width="148" x="514" y="733"/><ellipse cx="529" cy="749" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M531.4731,755.1431 Q530.8921,755.4419 530.2529,755.5913 Q529.6138,755.7407 528.9082,755.7407 Q526.4014,755.7407 525.0815,754.0889 Q523.7617,752.437 523.7617,749.3159 Q523.7617,746.1865 525.0815,744.5347 Q526.4014,742.8828 528.9082,742.8828 Q529.6138,742.8828 530.2612,743.0322 Q530.9087,743.1816 531.4731,743.4805 L531.4731,746.2031 Q530.8423,745.6221 530.2488,745.3523 Q529.6553,745.0825 529.0244,745.0825 Q527.6797,745.0825 526.9949,746.1492 Q526.3101,747.2158 526.3101,749.3159 Q526.3101,751.4077 526.9949,752.4744 Q527.6797,753.541 529.0244,753.541 Q529.6553,753.541 530.2488,753.2712 Q530.8423,753.0015 531.4731,752.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116" x="543" y="753.5352">CommunicationTask</text><line style="stroke:#A80036;stroke-width:1.5;" x1="515" x2="661" y1="765" y2="765"/><line style="stroke:#A80036;stroke-width:1.5;" x1="515" x2="661" y1="773" y2="773"/><!--MD5=[60d6b92408f98aed8df94d5c6e04aa63]
class State--><rect codeLine="48" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="99.8203" id="State" style="stroke:#A80036;stroke-width:1.5;" width="133" x="504.5" y="302.5"/><ellipse cx="552.75" cy="318.5" fill="#A9DCDF" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M552.6133,313.8481 L551.4595,318.9199 L553.7754,318.9199 Z M551.1191,311.6069 L554.1157,311.6069 L557.4609,324 L555.0122,324 L554.2485,320.937 L550.9697,320.937 L550.2227,324 L547.7739,324 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="28" x="573.25" y="323.0352">State</text><line style="stroke:#A80036;stroke-width:1.5;" x1="505.5" x2="636.5" y1="334.5" y2="334.5"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="512.5" y="342.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="58" x="524.5" y="349.1348">task: Task*</text><line style="stroke:#A80036;stroke-width:1.5;" x1="505.5" x2="636.5" y1="355.4551" y2="355.4551"/><ellipse cx="515.5" cy="366.4551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="107" x="524.5" y="370.0898">setTask(task: Task*)</text><ellipse cx="515.5" cy="379.4102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="524.5" y="383.0449">getTask(): Task*</text><ellipse cx="515.5" cy="392.3652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="44" x="524.5" y="396">handle()</text><path d="M672.5,309 L672.5,348.5 L637.81,352.5 L672.5,356.5 L672.5,395.5527 A0,0 0 0 0 672.5,395.5527 L847.5,395.5527 A0,0 0 0 0 847.5,395.5527 L847.5,319 L837.5,309 L672.5,309 A0,0 0 0 0 672.5,309 " fill="#FBFB77" filter="url(#f12b7wkof0s6r6)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M837.5,309 L837.5,319 L847.5,319 L837.5,309 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="678.5" y="326.5684">State pattern: all the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="678.5" y="341.8789">concrete states extends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="678.5" y="357.1895">this abstract class</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="678.5" y="372.5">re-defining the handle()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="678.5" y="387.8105">method.</text><!--MD5=[1337a0cce0671f1bf71893bca8a76aa6]
class Machine--><rect codeLine="58" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="216.416" id="Machine" style="stroke:#A80036;stroke-width:1.5;" width="219" x="229.5" y="7"/><ellipse cx="311.25" cy="23" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M307.6777,19.2651 L307.6777,17.1069 L315.0571,17.1069 L315.0571,19.2651 L312.5918,19.2651 L312.5918,27.3418 L315.0571,27.3418 L315.0571,29.5 L307.6777,29.5 L307.6777,27.3418 L310.1431,27.3418 L310.1431,19.2651 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="47" x="331.75" y="27.5352">Machine</text><line style="stroke:#A80036;stroke-width:1.5;" x1="230.5" x2="447.5" y1="39" y2="39"/><line style="stroke:#A80036;stroke-width:1.5;" x1="230.5" x2="447.5" y1="47" y2="47"/><ellipse cx="240.5" cy="58" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="133" x="249.5" y="61.6348">updateSugarLevel(): bool</text><ellipse cx="240.5" cy="70.9551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="161" x="249.5" y="74.5898">updateSelectedProduct(): bool</text><ellipse cx="240.5" cy="83.9102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="32" x="249.5" y="87.5449">refill()</text><ellipse cx="240.5" cy="96.8652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="249.5" y="100.5">displaySelections()</text><ellipse cx="240.5" cy="109.8203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="249.5" y="113.4551">make()</text><ellipse cx="240.5" cy="122.7754" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="249.5" y="126.4102">isMaking(): bool</text><ellipse cx="240.5" cy="135.7305" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="28" x="249.5" y="139.3652">test()</text><ellipse cx="240.5" cy="148.6855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="249.5" y="152.3203">isTesting(): bool</text><ellipse cx="240.5" cy="161.6406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="168" x="249.5" y="165.2754">getMachineTemperature(): float</text><ellipse cx="240.5" cy="174.5957" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="249.5" y="178.2305">detectingSomeone(): bool</text><ellipse cx="240.5" cy="187.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="193" x="249.5" y="191.1855">setMachineState(MachineState state)</text><ellipse cx="240.5" cy="200.5059" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="171" x="249.5" y="204.1406">getMachineState(): MachineState</text><ellipse cx="240.5" cy="213.4609" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="90" x="249.5" y="217.0957">getInfos(): String</text><!--MD5=[ed35f5a0aba35e5970e861c2551f2fa8]
class MachineState--><rect codeLine="83" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="112.7754" id="MachineState" style="stroke:#A80036;stroke-width:1.5;" width="107" x="483.5" y="58.5"/><ellipse cx="498.5" cy="74.5" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M502.1143,81 L494.3945,81 L494.3945,68.6069 L502.1143,68.6069 L502.1143,70.7651 L496.8433,70.7651 L496.8433,73.438 L501.6162,73.438 L501.6162,75.5962 L496.8433,75.5962 L496.8433,78.8418 L502.1143,78.8418 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="512.5" y="79.0352">MachineState</text><line style="stroke:#A80036;stroke-width:1.5;" x1="484.5" x2="589.5" y1="90.5" y2="90.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="39" x="489.5" y="105.1348">READY,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="65" x="489.5" y="118.0898">DISPENSING,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="69" x="489.5" y="131.0449">ASSISTANCE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="48" x="489.5" y="144">TESTING,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="49" x="489.5" y="156.9551">SLEEPING</text><line style="stroke:#A80036;stroke-width:1.5;" x1="484.5" x2="589.5" y1="163.2754" y2="163.2754"/><path d="M626,71.5 L626,111 L590.84,115 L626,119 L626,158.0527 A0,0 0 0 0 626,158.0527 L818,158.0527 A0,0 0 0 0 818,158.0527 L818,81.5 L808,71.5 L626,71.5 A0,0 0 0 0 626,71.5 " fill="#FBFB77" filter="url(#f12b7wkof0s6r6)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M808,71.5 L808,81.5 L818,81.5 L808,71.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="632" y="89.0684">The predefined states in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="632" y="104.3789">which the machine can be.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="632" y="119.6895">This is used for a shared</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="632" y="135">variable for orchestrating</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="632" y="150.3105">all the tasks.</text><!--MD5=[72136138052d025cffdce3c22fbd185f]
class Product--><rect codeLine="93" fill="#FEFECE" filter="url(#f12b7wkof0s6r6)" height="112.7754" id="Product" style="stroke:#A80036;stroke-width:1.5;" width="137" x="57.5" y="58.5"/><ellipse cx="99.95" cy="74.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M96.3777,70.7651 L96.3777,68.6069 L103.7571,68.6069 L103.7571,70.7651 L101.2918,70.7651 L101.2918,78.8418 L103.7571,78.8418 L103.7571,81 L96.3777,81 L96.3777,78.8418 L98.8431,78.8418 L98.8431,70.7651 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="44" x="120.05" y="79.0352">Product</text><line style="stroke:#A80036;stroke-width:1.5;" x1="58.5" x2="193.5" y1="90.5" y2="90.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="58.5" x2="193.5" y1="98.5" y2="98.5"/><ellipse cx="68.5" cy="109.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="57" x="77.5" y="113.1348">consume()</text><ellipse cx="68.5" cy="122.4551" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="77.5" y="126.0898">refill(quantity: int)</text><ellipse cx="68.5" cy="135.4102" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="77.5" y="139.0449">getLeftQuantity(): int</text><ellipse cx="68.5" cy="148.3652" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="77.5" y="152">isAvailable(): bool</text><ellipse cx="68.5" cy="161.3203" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="77.5" y="164.9551">toString(): String</text><!--MD5=[eea690669a3d09b9e21fb1597193e640]
link Scheduler to Task--><path codeLine="20" d="M185.16,352.5 C185.16,352.5 192.38,352.5 195.37,352.5 " fill="none" id="Scheduler-Task" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="208.47,352.5,199.47,348.5,203.47,352.5,199.47,356.5,208.47,352.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="203.47" x2="195.47" y1="352.5" y2="352.5"/><polygon fill="#A80036" points="173.16,352.5,179.16,356.5,185.16,352.5,179.16,348.5,173.16,352.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="180.9227" y="349.4282">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="194.333" y="349.6276">*</text><!--MD5=[fe76cbf1f0be9115fed4cbc82a513d37]
reverse link Task to BaseTask--><path d="M339,429.35 C339,446.16 339,464.18 339,481.64 " fill="none" id="Task-backto-BaseTask" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="332,429.2,339,409.2,346,429.2,332,429.2" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[e6c9165f799c4e937781f4fe28a7d0d5]
reverse link BaseTask to MainTask--><path d="M206.44,685.94 C184.59,703.65 164.02,720.32 148.43,732.95 " fill="none" id="BaseTask-backto-MainTask" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="202.18,680.38,222.13,673.23,211,691.26,202.18,680.38" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[714100d91924d26a9f2f03a12e5b5573]
reverse link BaseTask to DispensingTask--><path d="M288.69,691.55 C281.74,707.15 275.28,721.66 270.26,732.95 " fill="none" id="BaseTask-backto-DispensingTask" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="282.31,688.65,296.84,673.23,295.1,694.34,282.31,688.65" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[4de247d5eb651e5d9265de14a263694d]
reverse link BaseTask to SelfTestingTask--><path d="M389.31,691.55 C396.26,707.15 402.72,721.66 407.74,732.95 " fill="none" id="BaseTask-backto-SelfTestingTask" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="382.9,694.34,381.16,673.23,395.69,688.65,382.9,694.34" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a2ff63d160fd5a82bde96f467ae2e481]
reverse link BaseTask to CommunicationTask--><path d="M486.07,683.34 C512.16,701.94 536.88,719.56 555.44,732.79 " fill="none" id="BaseTask-backto-CommunicationTask" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="481.92,688.98,469.7,671.67,490.05,677.58,481.92,688.98" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f4480fde34404bc784556a9de0e60a06]
link Task to State--><path codeLine="55" d="M481.8397,392.5469 C481.8397,392.5469 488.84,391.29 491.71,390.63 " fill="none" id="Task-State" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="504.29,387.22,494.5586,385.7037,499.4628,388.523,496.6434,393.4272,504.29,387.22" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="499.4628" x2="491.745" y1="388.523" y2="390.62"/><polygon fill="#FFFFFF" points="469.95,394.17,476.4359,397.3217,481.8397,392.5469,475.3538,389.3952,469.95,394.17" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f4480fde34404bc784556a9de0e60a06]
link Task to State--><path codeLine="56" d="M483.1,312.61 C485.97,313.12 492.7047,314.6527 492.7047,314.6527 " fill="none" id="Task-State-1" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="504.29,317.78,499.5397,312.3546,492.7047,314.6527,497.4549,320.0782,504.29,317.78" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="469.95,310.83,478.3262,316.0106,474.9041,311.5063,479.4083,308.0841,469.95,310.83" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="474.9041" x2="482.835" y1="311.5063" y2="312.575"/><!--MD5=[4d2ffc7ed516b3c01437aeeec6c798fc]
link Machine to Task--><path codeLine="74" d="M339,223.07 C339,243.31 339,263.97 339,282.64 " fill="none" id="Machine-to-Task" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="339,295.85,343,289.85,339,283.85,335,289.85,339,295.85" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[670051a3b0303a4c5eba9db495767d90]
link Machine to MachineState--><path codeLine="91" d="M448.83,115 C455.91,115 463,115 470.09,115 " fill="none" id="Machine-to-MachineState" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="483.27,115,477.27,111,471.27,115,477.27,119,483.27,115" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[c8a4ae9de61b9faf6502f8a7a3df3751]
reverse link Product to Machine--><path codeLine="101" d="M207.65,115 C214.87,115 222.1,115 229.32,115 " fill="none" id="Product-backto-Machine" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="194.64,115,200.64,119,206.64,115,200.64,111,194.64,115" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[084dcdac964fb11bdd710234b7d457f2]
@startuml class-diagram 

class Scheduler {
    - basePeriod: int 
    - tasks: list<Task*>
    - timer: Timer1
    - elapsedTime: int
    + Scheduler(basePeriod: int)
    + addTask(task:Task*): bool
    + schedule()
}

interface Task {
    + init(state: State*)
    + stateTransition(nextState: State*)
    + execute()
    + updateAndCheckTime(basePeriod: int): bool
    + getMachine(): Machine*
}

Scheduler "1" *-right-> "*" Task

abstract class BaseTask implements Task {
    - myPeriod: int
    - elapsedTime: int
    - currentState: State*
    - machine: Machine*
    - actualState: State*
    + Task(period: int)
    + init(state: State*)
    + stateTransition(nextState: State*)
    + execute()
    + updateAndCheckTime(basePeriod: int): bool
    + getMachine(): Machine*
}

class MainTask extends BaseTask
class DispensingTask extends BaseTask
class SelfTestingTask extends BaseTask
class CommunicationTask extends BaseTask

note right of State
State pattern: all the 
concrete states extends 
this abstract class
re-defining the handle()
method.
end note
abstract class State {
    - task: Task*
    + setTask(task: Task*)
    + getTask(): Task*
    + {abstract} handle()
}

Task o-right-> State
State o-left-> Task

interface Machine {
    + updateSugarLevel(): bool
    + updateSelectedProduct(): bool
    + refill()
    + displaySelections()
    + make()
    + isMaking(): bool
    + test()
    + isTesting(): bool
    + getMachineTemperature(): float
    + detectingSomeone(): bool
    + setMachineState(MachineState state)
    + getMachineState(): MachineState
    + getInfos(): String
}

Machine - -o Task

note right of MachineState
The predefined states in 
which the machine can be. 
This is used for a shared 
variable for orchestrating
all the tasks.
end note
enum MachineState {
    READY,
    DISPENSING,
    ASSISTANCE,
    TESTING,
    SLEEPING
}

Machine -right-* MachineState

interface Product {
    + consume()
    + refill(quantity: int)
    + getLeftQuantity(): int
    + isAvailable(): bool
    + toString(): String
}

Machine -left-o Product


@enduml

PlantUML version 1.2022.0(Tue Jan 11 17:16:42 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IT
--></g></svg>